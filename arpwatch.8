.\" @(#) $Header: arpwatch.8,v 1.10 97/10/31 12:02:26 leres Exp $ (LBL)
.\"
.\" Copyright (c) 1992, 1994, 1996, 1997
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that: (1) source code distributions
.\" retain the above copyright notice and this paragraph in its entirety, (2)
.\" distributions including binary code include the above copyright notice and
.\" this paragraph in its entirety in the documentation or other materials
.\" provided with the distribution, and (3) all advertising materials mentioning
.\" features or use of this software display the following acknowledgement:
.\" ``This product includes software developed by the University of California,
.\" Lawrence Berkeley Laboratory and its contributors.'' Neither the name of
.\" the University nor the names of its contributors may be used to endorse
.\" or promote products derived from this software without specific prior
.\" written permission.
.\" THIS SOFTWARE IS PROVIDED ``AS IS'' AND WITHOUT ANY EXPRESS OR IMPLIED
.\" WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
.\"
.TH ARPSNMP 8 "31 October 1997"
.UC 4
.SH NAME
arpsnmp - keep track of ethernet/ip address pairings
.SH SYNOPSIS
.B arpsnmp
[
.UC 4
.SH NAME
arpwatch - keep track of ethernet/ip address pairings
.SH SYNOPSIS
.na
.B arpwatch
[
.B -d
] [
.B -f
.I datafile
] [
.B -i
.I interface
]
.br
.ti +8
[
.B -r
.I file
]
.ad
.SH DESCRIPTION
.B Arpwatch
keeps track for ethernet/ip address pairings. It syslogs activity
and reports certain changes via email.
.B Arpwatch
uses 
.BR pcap (3)
to listen for arp packets on a local ethernet interface.
.LP
The
.B -d
flag is used enable debugging. This also inhibits forking into the
background and emailing the reports. Instead, they are sent to
.IR stderr .
.LP
The
.B -f
flag is used to set the ethernet/ip address database filename.
The default is
.IR arp.dat .
.LP
The
.B -i
flag is used to override the default interface.
.LP
The
.B -r
flag is used to specify a savefile
(perhaps created by
.BR tcpdump (1)
or
.BR pcapture (1))
to read from instead
of reading from the network. In this case,
.B arpwatch
does not fork.
.LP
Note that an empty
.I arp.dat
file must be created before the first time you run
.BR arpwatch .
.LP
.SH "REPORT MESSAGES"
Here's a quick list of the report messages generated by
.BR arpwatch (1)
(and
.BR arpsnmp (1)):
.TP
.B "new activity"
This ethernet/ip address pair has been used for the first time six
months or more.
.TP
.B "new station"
The ethernet address has not been seen before.
.TP
.B "flip flop"
The ethernet address has changed from the most recently seen address to
the second most recently seen address.
(If either the old or new ethernet address is a DECnet address and it
is less than 24 hours, the email version of the report is suppressed.)
.TP
.B "reused old ethernet address"
The ethernet address has changed from the most recently seen address to
the third (or greater) least recently seen address.
(This is similar to a flip flop.)
.TP
.B "changed ethernet address"
The host switched to a new ethernet address.
.SH FILES
.na
.nh
.nf
/usr/operator/arpwatch - default directory
arp.dat - ethernet/ip address database
ethercodes.dat - vendor ethernet block list
.ad
.hy
.fi
.SH "SEE ALSO"
.na
.nh
.BR arpsnmp (8),
.BR arp (8),
.BR bpf (4),
.BR tcpdump (1),
.BR pcapture (1),
.BR pcap (3)
.ad
.hy
.SH AUTHORS
Craig Leres of the
Lawrence Berkeley National Laboratory Network Research Group,
University of California, Berkeley, CA.
.LP
The current version is available via anonymous ftp:
.LP
.RS
.I ftp://ftp.ee.lbl.gov/arpwatch.tar.Z
.RE
.SH BUGS
Please send bug reports to arpwatch@ee.lbl.gov.
.LP
Attempts are made to suppress DECnet flip flops but they
aren't always successful.
.LP
Most error messages are posted using syslog.
